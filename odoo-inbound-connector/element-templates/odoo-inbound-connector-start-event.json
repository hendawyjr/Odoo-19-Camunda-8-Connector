{
    "$schema": "https://unpkg.com/@camunda/zeebe-element-templates-json-schema/resources/schema.json",
    "name": "Odoo Webhook (Start Event)",
    "id": "io.camunda.connector.Odoo.Inbound.StartEvent.Webhook.v1",
    "description": "Start a process when Odoo sends a webhook event (create, update, delete)",
    "metadata": {
        "keywords": [
            "odoo",
            "erp",
            "webhook",
            "inbound"
        ]
    },
    "documentationRef": "https://www.odoo.com/documentation/19.0/developer/reference/external_api.html",
    "version": 1,
    "category": {
        "id": "connectors",
        "name": "Connectors"
    },
    "appliesTo": [
        "bpmn:StartEvent"
    ],
    "elementType": {
        "value": "bpmn:StartEvent",
        "eventDefinition": "bpmn:MessageEventDefinition"
    },
    "groups": [
        {
            "id": "webhook",
            "label": "Webhook Configuration"
        },
        {
            "id": "activation",
            "label": "Activation"
        },
        {
            "id": "correlation",
            "label": "Correlation",
            "tooltip": "Learn more about message correlation in the <a href=\"https://docs.camunda.io/docs/components/concepts/messages/#message-correlation-overview\">documentation</a>."
        },
        {
            "id": "output",
            "label": "Output Mapping"
        }
    ],
    "properties": [
        {
            "value": "io.camunda:odoo-inbound:1",
            "binding": {
                "name": "inbound.type",
                "type": "zeebe:property"
            },
            "type": "Hidden"
        },
        {
            "id": "secretToken",
            "label": "Secret Token",
            "description": "Secret token to validate webhook requests from Odoo",
            "optional": false,
            "constraints": {
                "notEmpty": true
            },
            "feel": "optional",
            "group": "webhook",
            "binding": {
                "name": "secretToken",
                "type": "zeebe:property"
            },
            "type": "String"
        },
        {
            "id": "allowedModels",
            "label": "Allowed Models",
            "description": "Comma-separated list of Odoo model names (e.g., res.partner,sale.order). Leave empty for all.",
            "optional": true,
            "feel": "optional",
            "group": "webhook",
            "binding": {
                "name": "allowedModels",
                "type": "zeebe:property"
            },
            "type": "String"
        },
        {
            "id": "eventType",
            "label": "Event Type",
            "description": "Type of Odoo event to listen for",
            "optional": false,
            "value": "all",
            "group": "webhook",
            "binding": {
                "name": "eventType",
                "type": "zeebe:property"
            },
            "type": "Dropdown",
            "choices": [
                {
                    "name": "All Events",
                    "value": "all"
                },
                {
                    "name": "Create Only",
                    "value": "create"
                },
                {
                    "name": "Update Only",
                    "value": "write"
                },
                {
                    "name": "Delete Only",
                    "value": "unlink"
                },
                {
                    "name": "Create or Update",
                    "value": "create_write"
                }
            ]
        },
        {
            "id": "activationCondition",
            "label": "Activation Condition",
            "description": "Condition under which the connector triggers. Leave empty to catch all events.",
            "optional": true,
            "feel": "required",
            "group": "activation",
            "binding": {
                "name": "activationCondition",
                "type": "zeebe:property"
            },
            "type": "String"
        },
        {
            "id": "correlationRequired",
            "label": "Subprocess Correlation Required",
            "description": "Indicates whether correlation is required (for event-based subprocess message start events)",
            "value": "notRequired",
            "group": "correlation",
            "binding": {
                "name": "correlationRequired",
                "type": "zeebe:property"
            },
            "type": "Dropdown",
            "choices": [
                {
                    "name": "Correlation not required",
                    "value": "notRequired"
                },
                {
                    "name": "Correlation required",
                    "value": "required"
                }
            ]
        },
        {
            "id": "correlationKeyProcess",
            "label": "Correlation Key (Process)",
            "description": "Sets up the correlation key from process variables",
            "constraints": {
                "notEmpty": true
            },
            "feel": "required",
            "group": "correlation",
            "binding": {
                "name": "correlationKey",
                "type": "bpmn:Message#zeebe:subscription#property"
            },
            "condition": {
                "property": "correlationRequired",
                "equals": "required",
                "type": "simple"
            },
            "type": "String"
        },
        {
            "id": "correlationKeyPayload",
            "label": "Correlation Key (Payload)",
            "description": "Extracts the correlation key from the incoming Odoo event (e.g., =odooRecordId)",
            "constraints": {
                "notEmpty": true
            },
            "feel": "required",
            "group": "correlation",
            "binding": {
                "name": "correlationKeyExpression",
                "type": "zeebe:property"
            },
            "condition": {
                "property": "correlationRequired",
                "equals": "required",
                "type": "simple"
            },
            "type": "String"
        },
        {
            "id": "messageTtl",
            "label": "Message TTL",
            "description": "Time-to-live for the message in the broker (ISO-8601 duration)",
            "optional": true,
            "constraints": {
                "notEmpty": false,
                "pattern": {
                    "value": "^(PT.*|)$",
                    "message": "must be an ISO-8601 duration"
                }
            },
            "feel": "optional",
            "group": "correlation",
            "binding": {
                "name": "messageTtl",
                "type": "zeebe:property"
            },
            "type": "String"
        },
        {
            "id": "messageIdExpression",
            "label": "Message ID Expression",
            "description": "Expression to extract unique identifier of a message",
            "optional": true,
            "feel": "required",
            "group": "correlation",
            "binding": {
                "name": "messageIdExpression",
                "type": "zeebe:property"
            },
            "type": "String"
        },
        {
            "id": "messageNameUuid",
            "generatedValue": {
                "type": "uuid"
            },
            "group": "correlation",
            "binding": {
                "name": "name",
                "type": "bpmn:Message#property"
            },
            "type": "Hidden"
        },
        {
            "id": "resultVariable",
            "label": "Result Variable",
            "description": "Name of variable to store the Odoo event in",
            "group": "output",
            "binding": {
                "name": "resultVariable",
                "type": "zeebe:property"
            },
            "type": "String"
        },
        {
            "id": "resultExpression",
            "label": "Result Expression",
            "description": "Expression to map the Odoo event into process variables",
            "feel": "required",
            "group": "output",
            "binding": {
                "name": "resultExpression",
                "type": "zeebe:property"
            },
            "type": "Text"
        }
    ],
    "icon": {
        "contents": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiB3aWR0aD0iMTgiIGhlaWdodD0iMTgiPgogIDxkZWZzPgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJvZG9vR3JhZGllbnQiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojNzE0QjY3O3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiM4NzVBN0I7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0NSIgZmlsbD0idXJsKCNvZG9vR3JhZGllbnQpIi8+CiAgPHBhdGggZD0iTTMwIDUwIEMzMCAzOCAzOCAzMCA1MCAzMCBDNjIgMzAgNzAgMzggNzAgNTAgQzcwIDYyIDYyIDcwIDUwIDcwIEMzOCA3MCAzMCA2MiAzMCA1MCBaIE00MCA1MCBDNDAgNTYgNDQgNjAgNTAgNjAgQzU2IDYwIDYwIDU2IDYwIDUwIEM2MCA0NCA1NiA0MCA1MCA0MCBDNDQgNDAgNDAgNDQgNDAgNTAgWiIgZmlsbD0id2hpdGUiLz4KICA8Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI4IiBmaWxsPSJ3aGl0ZSIvPgogIDxwYXRoIGQ9Ik03NSAyNSBMODUgMzUgTTc1IDM1IEw4NSAyNSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz4KPC9zdmc+"
    }
}